<p align="center">
  <img src="logo.png" alt="å²©é£ AI Task" width="300"/>
</p>

<h1 align="center">Yanfeng AI Task</h1>

<p align="center">
  <strong>åŸºäº ModelScope çš„ Home Assistant AI é›†æˆ</strong>
</p>

<p align="center">
  <a href="https://github.com/custom-components/hacs">
    <img src="https://img.shields.io/badge/HACS-Custom-orange.svg" alt="HACS Custom">
  </a>
  <img src="https://img.shields.io/badge/Home%20Assistant-2024.10+-blue.svg" alt="Home Assistant">
  <img src="https://img.shields.io/badge/Python-3.11+-blue.svg" alt="Python">
  <img src="https://img.shields.io/badge/ModelScope-API-green.svg" alt="ModelScope">
</p>

---

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ¤– **å¯¹è¯ä»£ç†** - æ”¯æŒä¸­æ–‡å’Œå¤šè¯­è¨€è‡ªç„¶è¯­è¨€å¯¹è¯
- ğŸ“ **AI ä»»åŠ¡ç”Ÿæˆæ•°æ®** - ç”Ÿæˆæ–‡æœ¬ã€ç»“æ„åŒ– JSON æ•°æ®
- ğŸ–¼ï¸ **å›¾åƒç”Ÿæˆ** - ä½¿ç”¨ ModelScope å›¾åƒæ¨¡å‹ç”Ÿæˆå›¾ç‰‡
- ğŸ‘ï¸ **å›¾åƒè¯†åˆ«** - æ”¯æŒè§†è§‰æ¨¡å‹è¯†åˆ«å›¾ç‰‡å†…å®¹
- ğŸ“Š **ç»“æ„åŒ–è¾“å‡º** - æ”¯æŒ JSON Schema æ ¼å¼åŒ–å“åº”
- ğŸ”„ **å¤šæ¨¡æ€æ”¯æŒ** - æ–‡æœ¬ + å›¾åƒæ··åˆè¾“å…¥

## ğŸ¯ æ”¯æŒçš„æ¨¡å‹

### æ–‡æœ¬æ¨¡å‹
- **Qwen/Qwen2.5-72B-Instruct** - æœ€å¼ºå¤§çš„å¯¹è¯æ¨¡å‹ï¼ˆæ¨èï¼‰
- **Qwen/Qwen2.5-32B-Instruct** - é«˜æ€§èƒ½å¹³è¡¡æ¨¡å‹
- **Qwen/Qwen2.5-14B-Instruct** - ä¸­ç­‰è§„æ¨¡æ¨¡å‹
- **Qwen/Qwen2.5-7B-Instruct** - å¿«é€Ÿå“åº”æ¨¡å‹

### è§†è§‰æ¨¡å‹
- **Qwen/Qwen3-VL-235B-A22B-Instruct** - æœ€æ–°è§†è§‰è¯­è¨€æ¨¡å‹ï¼ˆæ¨èï¼‰
- **Qwen/Qwen2-VL-72B-Instruct** - é«˜æ€§èƒ½è§†è§‰æ¨¡å‹

### å›¾åƒç”Ÿæˆæ¨¡å‹
- **Qwen/Qwen-Image** - Qwen å›¾åƒç”Ÿæˆï¼ˆæ¨èï¼‰
- **stable-diffusion-v1-5** - Stable Diffusion 1.5
- **stable-diffusion-xl-base-1-0** - SDXL åŸºç¡€æ¨¡å‹

## ğŸ“¦ å®‰è£…

### æ–¹æ³•1ï¼šé€šè¿‡ HACSï¼ˆæ¨èï¼‰

1. æ‰“å¼€ HACS
2. ç‚¹å‡»å³ä¸Šè§’èœå•ï¼Œé€‰æ‹© **"è‡ªå®šä¹‰å­˜å‚¨åº“"**
3. æ·»åŠ æ­¤å­˜å‚¨åº“ URL: https://github.com/yanfeng17/yanfeng_ai_task
4. æœç´¢ **"Yanfeng AI Task"**
5. ç‚¹å‡» **å®‰è£…**
6. é‡å¯ Home Assistant

### æ–¹æ³•2ï¼šæ‰‹åŠ¨å®‰è£…

1. ä¸‹è½½æœ€æ–°ç‰ˆæœ¬
2. è§£å‹åˆ° `custom_components/yanfeng_ai_task/`
3. é‡å¯ Home Assistant

## âš™ï¸ é…ç½®

### ç¬¬ä¸€æ­¥ï¼šè·å– ModelScope API Key

1. è®¿é—® [ModelScope](https://modelscope.cn/my/myaccesstoken)
2. æ³¨å†Œå¹¶ç™»å½•è´¦æˆ·
3. åˆ›å»º **API Token**
4. ç¡®ä¿è´¦æˆ·æœ‰è¶³å¤Ÿçš„é¢åº¦ï¼Œé­”æ­å¹³å°æ¯å¤©æœ‰2000ç‚¹é¢åº¦å¯ä»¥å…è´¹ä½¿ç”¨
<img width="1426" height="269" alt="img_v3_02r1_ff29e809-fba0-49de-8600-f3755c286a9g" src="https://github.com/user-attachments/assets/e2bc939c-2dcb-49df-ac20-090c2b53ac25" />


### ç¬¬äºŒæ­¥ï¼šæ·»åŠ é›†æˆ

1. è¿›å…¥ Home Assistant **è®¾ç½® > è®¾å¤‡ä¸æœåŠ¡**
2. ç‚¹å‡» **"æ·»åŠ é›†æˆ"**
3. æœç´¢ **"Yanfeng AI Task"**
4. è¾“å…¥ **ModelScope API Key**
5. é€‰æ‹©æ¨¡å‹å’Œå‚æ•°ï¼š
   - **å¯¹è¯æ¨¡å‹**: Qwen/Qwen2.5-72B-Instructï¼ˆæ¨èï¼‰
   - **æ¸©åº¦**: 0.7
   - **Max Tokens**: 2048
6. å®Œæˆé…ç½®

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### 1. å¯¹è¯ä»£ç†

åœ¨ **è®¾ç½® > è¯­éŸ³åŠ©æ‰‹** ä¸­é€‰æ‹© **"Yanfeng AI Task"** ä½œä¸ºå¯¹è¯ä»£ç†ï¼š

```
ä½ : ä½ å¥½
AI: ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ
```

### 2. AI Task ç”Ÿæˆæ–‡æœ¬

```yaml
action: ai_task.generate_data
data:
  instructions: å†™ä¸€é¦–å…³äºæ˜¥å¤©çš„è¯—
  entity_id: ai_task.yanfeng_ai_task
response_variable: poem
```

### 3. å›¾åƒç”Ÿæˆ

```yaml
action: ai_task.generate_image
data:
  prompt: ä¸€åªå¯çˆ±çš„å°çŒ«åœ¨èŠ±å›­é‡Œç©è€
  entity_id: ai_task.yanfeng_ai_task
```

### 4. å›¾åƒè¯†åˆ«

```yaml
action: ai_task.generate_data
data:
  instructions: æè¿°è¿™å¼ å›¾ç‰‡ä¸­çš„å†…å®¹
  attachments:
    media_content_id: media-source://camera/camera.video
    media_content_type: image/jpeg
  entity_id: ai_task.yanfeng_ai_task
response_variable: description
```

### 5. ç»“æ„åŒ–è¾“å‡º

```yaml
action: ai_task.generate_data
data:
  instructions: åˆ†æäººç‰©ç‰¹å¾
  attachments:
    media_content_id: media-source://camera/camera.video
  structure:
    name:
      description: äººç‰©åç§°
    age:
      description: ä¼°è®¡å¹´é¾„
    clothing:
      description: æœè£…æè¿°
  entity_id: ai_task.yanfeng_ai_task
response_variable: analysis
```

**è¿”å›ç¤ºä¾‹**ï¼š
```json
{
  "name": "æœªçŸ¥",
  "age": "çº¦25å²",
  "clothing": "è“è‰²Tæ¤å’Œç‰›ä»”è£¤"
}
```

### 6. åœ¨è‡ªåŠ¨åŒ–ä¸­ä½¿ç”¨

```yaml
automation:
  - alias: "é—¨é“ƒè¯†åˆ«æ¥è®¿è€…"
    trigger:
      platform: state
      entity_id: binary_sensor.doorbell
      to: "on"
    action:
      - action: ai_task.generate_data
        data:
          instructions: æè¿°é—¨å£çš„äººç‰©ç‰¹å¾
          attachments:
            media_content_id: media-source://camera/doorbell
            media_content_type: image/jpeg
          structure:
            description:
              description: äººç‰©æè¿°
            count:
              description: äººæ•°
          entity_id: ai_task.yanfeng_ai_task
        response_variable: visitor_info
      - action: notify.mobile_app
        data:
          message: "æœ‰è®¿å®¢ï¼š{{ visitor_info.data.description }}"
```

## ğŸ“‹ é…ç½®é€‰é¡¹

| é€‰é¡¹ | æè¿° | é»˜è®¤å€¼ | èŒƒå›´ |
|------|------|--------|------|
| API Key | ModelScope API Token | å¿…å¡« | - |
| å¯¹è¯æ¨¡å‹ | ç”¨äºå¯¹è¯çš„æ¨¡å‹ | Qwen/Qwen2.5-72B-Instruct | è§æ”¯æŒçš„æ¨¡å‹ |
| æ¸©åº¦ | æ§åˆ¶å›ç­”çš„éšæœºæ€§ | 0.7 | 0.0 - 2.0 |
| Top P | æ ¸é‡‡æ ·å‚æ•° | 0.9 | 0.0 - 1.0 |
| æœ€å¤§ä»¤ç‰Œæ•° | å•æ¬¡å›ç­”çš„æœ€å¤§é•¿åº¦ | 2048 | 1 - 8192 |
| æç¤ºè¯ | ç³»ç»Ÿæç¤ºè¯ | "You are a helpful assistant." | è‡ªå®šä¹‰æ–‡æœ¬ |

## ğŸ”§ é«˜çº§åŠŸèƒ½

### å¤šæ¨¡æ€è¾“å…¥

æ”¯æŒæ–‡æœ¬ + å›¾åƒæ··åˆè¾“å…¥ï¼Œé€‚ç”¨äºï¼š
- å›¾åƒæè¿°
- è§†è§‰é—®ç­”
- åœºæ™¯ç†è§£
- ç‰©ä½“è¯†åˆ«

### ç»“æ„åŒ–è¾“å‡º

ä½¿ç”¨ `structure` å‚æ•°å®šä¹‰ JSON Schemaï¼Œæ¨¡å‹ä¼šè¿”å›ç¬¦åˆæ ¼å¼çš„ç»“æ„åŒ–æ•°æ®ï¼š

```yaml
structure:
  field_name:
    description: å­—æ®µæè¿°
    selector:
      text: null
```

### æµå¼å“åº”

éƒ¨åˆ†æ¨¡å‹æ”¯æŒæµå¼å“åº”ï¼ˆé€å­—è¿”å›ï¼‰ï¼Œæä¾›æ›´å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜1ï¼šAPI Key æ— æ•ˆ
**ç—‡çŠ¶**ï¼šæ— æ³•è¿æ¥åˆ° ModelScope API
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ API Key æ˜¯å¦æ­£ç¡®
- ç¡®è®¤è´¦æˆ·çŠ¶æ€æ­£å¸¸
- éªŒè¯ API é¢åº¦æ˜¯å¦å……è¶³

### é—®é¢˜2ï¼šå¯¹è¯æ— å“åº”
**ç—‡çŠ¶**ï¼šå‘é€æ¶ˆæ¯åæ²¡æœ‰å›å¤
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹æ—¥å¿—ä¸­çš„é”™è¯¯ä¿¡æ¯
- ç¡®è®¤é€‰æ‹©çš„æ¨¡å‹å¯ç”¨

### é—®é¢˜3ï¼šå›¾åƒè¯†åˆ«ä¸å·¥ä½œ
**ç—‡çŠ¶**ï¼šæ— æ³•è¯†åˆ«å›¾åƒå†…å®¹
**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®è®¤ä½¿ç”¨æ”¯æŒè§†è§‰çš„æ¨¡å‹
- æ£€æŸ¥å›¾åƒé™„ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®
- æŸ¥çœ‹æ—¥å¿—ç¡®è®¤å›¾åƒå·²æ·»åŠ 

### é—®é¢˜4ï¼šç»“æ„åŒ–è¾“å‡ºæ ¼å¼é”™è¯¯
**ç—‡çŠ¶**ï¼šè¿”å›çš„ä¸æ˜¯ JSON æ ¼å¼
**è§£å†³æ–¹æ¡ˆ**ï¼š
- æ£€æŸ¥ `structure` å‚æ•°å®šä¹‰æ˜¯å¦æ­£ç¡®
- ä½¿ç”¨æ›´è¯¦ç»†çš„å­—æ®µæè¿°
- å°è¯•ä½¿ç”¨æ›´å¼ºå¤§çš„æ¨¡å‹

### å¯ç”¨è°ƒè¯•æ—¥å¿—

åœ¨ `configuration.yaml` ä¸­æ·»åŠ ï¼š

```yaml
logger:
  default: info
  logs:
    custom_components.yanfeng_ai_task: debug
    homeassistant.components.conversation: debug
    homeassistant.components.ai_task: debug
```

é‡å¯åæŸ¥çœ‹æ—¥å¿—ï¼š
```bash
tail -f /config/home-assistant.log | grep yanfeng
```

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

### é€‰æ‹©åˆé€‚çš„æ¨¡å‹
- **å¿«é€Ÿå“åº”**: Qwen2.5-7B-Instruct
- **å¹³è¡¡**: Qwen2.5-32B-Instruct
- **æœ€ä½³è´¨é‡**: Qwen2.5-72B-Instruct
- **è§†è§‰ä»»åŠ¡**: Qwen3-VL-235B-A22B-Instruct

### è°ƒæ•´å‚æ•°
- **é™ä½ temperature** (0.3-0.5): æ›´å‡†ç¡®ã€ä¸€è‡´çš„å›ç­”
- **æé«˜ temperature** (0.8-1.0): æ›´åˆ›é€ æ€§çš„å›ç­”
- **å‡å°‘ max_tokens**: æ›´å¿«çš„å“åº”é€Ÿåº¦

## ğŸ“š æ›´å¤šèµ„æº

- [Home Assistant å®˜æ–¹æ–‡æ¡£](https://www.home-assistant.io/)
- [ModelScope å¹³å°](https://modelscope.cn/)
- [Qwen æ¨¡å‹æ–‡æ¡£](https://github.com/QwenLM)

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºå»ºè®®ï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®åŸºäº MIT è®¸å¯è¯å¼€æº - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ™ è‡´è°¢

- [Home Assistant](https://www.home-assistant.io/) - æ™ºèƒ½å®¶å±…å¹³å°
- [ModelScope](https://modelscope.cn/) - AI æ¨¡å‹æœåŠ¡
- [Qwen Team](https://github.com/QwenLM) - å¼ºå¤§çš„è¯­è¨€æ¨¡å‹

## ğŸ“ è”ç³»ä½œè€…æˆ–æ‰“èµæ„Ÿè°¢
<p align="center">
  <img src="https://github.com/user-attachments/assets/c1c5a7c8-1643-4ec8-a5a6-f76da3b90fc2" width="250">
  <img src="https://github.com/user-attachments/assets/873ff78e-b04e-4f89-9bb8-fa5fccadc775" width="250">
  <img src="https://github.com/user-attachments/assets/a3d7534a-77b8-407a-a559-1d9699cb23bc" width="250">
</p>

<p align="center">
  Made with â¤ï¸ by Yanfeng | Powered by ModelScope
</p>
